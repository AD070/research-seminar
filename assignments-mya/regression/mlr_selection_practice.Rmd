---
title: "Выбор модели множественной регрессии"
author: "Студент Школы логистики"
date: '02 марта 2018 г '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Введение

В файле `car_sales.csv` содержится информация о продажах автомобилей различных марок:  
- manufact - наименование производителя;  
- model - название модели;  
- country - страна производителя;  
- sales - объем продаж в тысячах;  
- resale - цена продажи 4-летнего автомобиля;  
- type - тип (автомобиль или грузовик);
- price - цена в тыс. долларов;  
- engine_s - объем двигателя;  
- horsepow - количество лошадиных сил;  
- wheelbas - колесная база;  
- width - ширина;  
- length - длина;  
- curb_wgt - вес кузова;  
- fuel_cap - вместимость топливного бака в галлонах;  												
- mpg - эффективность расхода топлива, милль на галлон.  												

```{r Загрузка пакетов, message=FALSE}
library(readr) # считывание данных из текстовых файлов
library(memisc) # удобное сравнение моделей в таблице
library(tidyverse) # манипулирование данными 
library(ggplot2) # визуализация 
library(ggfortify) # визуализация диагностических графиков
library(modelr) # вспомогательные функции для работы с моделями
library(broom) # преобразование результатов моделирования в табличный вид
library(GGally) # построение матрицы диаграмм рассеяния 
library(car) # функции для степенных преобразований
library(forcats) # работа с факторами
library(glmnet) # Лассо и ридж-регрессия
```

```{r Загрузка данных}
car_sales <- read_tsv("data/car_sales.csv", skip = 20, locale = locale(decimal_mark = ",", grouping_mark = "")) %>% na.omit() %>% select(resale, everything())
```

#Задания

1. Постройте модель множественной регрессии для прогнозирования цены 4-летнего автомобиля. С помощью коэффициента роста дисперсии (variance inflation factor) оцените, какие предикторы связаны друг с другом. Для каких предикторов коэффициенты уравнения регрессии найдены неверно?

```{r Выявление мультиколлинеарности}

```

2. Найдите лучшую модель для прогнозирования цены 4-летнего автомобиля методом полного перебора с помощью функции `leaps::regsubsets()`. Сравните результаты выбора модели при использовании в качестве критериев R^2, AIC, BIC.

```{r Полный перебор моделей}

```

3. Найдите лучшую модель для прогнозирования цены 4-летнего автомобиля методами пошаговой регрессии (stepwise regression) - исключения, включения, перебора (функция `stepAIC`). Сравните полученные модели с помощью функции `memisc::mtable()`.

```{r Пошаговая регрессия}

```

4. Найдите лучшую модель для прогнозирования цены 4-летнего автомобиля методом гребневой регрессии (ridge regression) с помощью функции `cv.glmnet()`.

```{r Гребневая регрессия}

```

5. Проверьте остатки полученных моделей. Нет ли гетескедастичности, нелинейной зависимости, влиятельных наблюдений?

```{r Проверка остатков модели}

```


